$(document).ready(function(){var t=.001,a=0,e=0,n=16,i=0,l="";$("div#location").text("ready");var c=L.map("map",{zoomControl:!1,dragging:!1,keyboard:!0}).fitWorld();L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(c),c.on("locationfound",function(o){var t=o.accuracy/2;l=L.marker(o.latlng).addTo(c),L.circle(o.latlng,t).addTo(c),i=o.latlng,a=i.lng,e=i.lat,$("div#location div#lat").text(e),$("div#location div#lng").text(a)}),c.on("locationerror",function(o){alert(o.message)}),c.locate({setView:!0,maxZoom:16}),n=16,s();var o={url:"https://nominatim.openstreetmap.org/search?format=json&q={s}",jsonpParam:"json_callback",formatData:function(o){var t,a,e={},n=[];for(var i in o)t=(n=o[i].display_name.split(","))[0]+", "+n[1],a=L.latLng(o[i].lat,o[i].lon),e[t]=a;return e},textPlaceholder:"Search...",autoType:!0,tipAutoSubmit:!0,autoCollapse:!0,collapsed:!1,autoCollapseTime:1e4,delayType:800,marker:{icon:!0}},r=new L.Control.Search(o);function d(t){function o(o){l.setLatLng([o.coords.latitude,o.coords.longitude]).update(),c.flyTo(new L.LatLng(o.coords.latitude,o.coords.longitude),16),n=16,s(),a=o.coords.longitude,e=o.coords.latitude,$("div#location div#lat").text(e),$("div#location div#lng").text(a),1==t&&$("div#location").css("display","block")}navigator.geolocation?navigator.geolocation.getCurrentPosition(o):alert("New Position not found.")}function s(){return n<6&&(t=1,document.getElementById("zoom-level").innerHTML=n+t),6<n&&(t=.1,document.getElementById("zoom-level").innerHTML=n+t),12<n&&(t=.001,document.getElementById("zoom-level").innerHTML=n+t),t}r.on("search:locationfound",function(o){i=o.latlng,a=i.lng,e=i.lat,$("div#location div#lat").text(e),$("div#location div#lng").text(a),$(".leaflet-control-search").css("display","none")}),c.addControl(r),$(".leaflet-control-search").css("display","none"),document.addEventListener("keydown",function(o){switch(o.key){case"SoftLeft":c.setZoom(c.getZoom()+1),n=c.getZoom(),s();break;case"SoftRight":c.setZoom(c.getZoom()-1),n=c.getZoom(),s();break;case"Enter":s();break;case"0":"none"==$("div#man-page").css("display")?($("div#man-page").css("display","block"),$("div#man-page").find("input").focus()):$("div#man-page").css("display","none");break;case"1":d();break;case"2":"none"==$(".leaflet-control-search").css("display")?($(".leaflet-control-search").css("display","block"),$(".leaflet-control-search").find("input").focus()):$(".leaflet-control-search").css("display","none");break;case"3":addTrack();break;case"4":d(),showLocation();break;case"ArrowRight":s(),$("div#location div#lat").text(e),$("div#location div#lng").text(a),a+=t,c.panTo(new L.LatLng(e,a));break;case"ArrowLeft":s(),$("div#location div#lat").text(e),$("div#location div#lng").text(a),a-=t,c.panTo(new L.LatLng(e,a));break;case"ArrowUp":s(),$("div#location div#lat").text(e),$("div#location div#lng").text(a),e+=t,c.panTo(new L.LatLng(e,a));break;case"ArrowDown":s(),$("div#location div#lat").text(e),$("div#location div#lng").text(a),e-=t,c.panTo(new L.LatLng(e,a))}})});